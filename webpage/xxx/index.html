<!DOCTYPE html>

<html lang="ja">

<HEAD>
<TITLE>S.Takeuchiのソフトウェア開発メモ</TITLE>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link rel="stylesheet" href="style.css" type="text/css">
</HEAD>

<BODY>

<div id="container">
<div class=spc>

<IMG SRC="head.gif" alt="Head bar"><BR>
<img src="titleimg.jpg" alt="Title"><br/>


<P>
<div class="base">
<u>S.Takeuchiのソフトウェア開発メモ</u><BR>
<div class="topic">
<a href="index.html#implnote">実装時気づき事項</a><br>
<a href="index.html#devkloc">開発規模について</a><br>
<a href="index.html#versionrule">バージョン表記に関する規約</a><br>
<a href="index.html#network">ネットワーク環境</a><br>
<a href="index.html#usedport">使用ポート番号</a><br>
<a href="index.html#backup">バックアップ方法</a><br>
</div>
</div>


<p>
<div class="base">
<u>歴代のPC / Server</u><BR>
<div class="topic">
<a href="index.html#takeuchi-xxx">VPS [takeuchi-xxx.com]</a><br>
<a href="index.html#kurosheeva">玄人志向 KURO-SHEEVA: ホスト名=Debian</a><br>
<a href="index.html#sublina">サブPC: ホスト名=Sublina</a><br>
<a href="index.html#neco">NECのPC: ホスト名=Neco</a><br>
<a href="index.html#shinyapc">ASUSのノートPC: ホスト名=SHINYA-PC</a><br>
</div>
</div>


<p>
<div class="base">
<u>関連リンク</u><BR>
<div class="topic">
<p>
■<A HREF="https://github.com/s-takeuchi">GitHub s-takeuchi</A><BR>
■<A HREF="http://www.pgelanguage.com/">ネイティブチェックのPGELanguage</A><BR>
■<A HREF="http://pro.foto.ne.jp/">プロカメラマンのフリー写真素材・無料画像素材 プロ・フォト</A><BR>
■<A HREF="http://www.vector.co.jp/">Vector ソフトウェアライブラリ</A><BR>
■<a href="http://www.google.com/">Google</a><br>
■<a href="http://outlook.live.com/">Outlook</a><br>
■<a href="https://msg.dream.jp/">DTI MyMail</a><br>
■<a href="https://www.facebook.com/">Facebook</a><br>
■<a href="https://validator.w3.org/">Markup Validation Service</a><br>
</p>
</div>
</div>


<p>
<IMG SRC="sep.gif" alt="Separator">


<p>
<hr>
<div class="base">
<u id="implnote">実装時気づき事項</u><BR>
<div class="topic">

<h3><b><u>インストーラがユーザードキュメントフォルダにフォルダ／ファイルを配置する際の注意事項</u></b></h3>
<div class="topic">
Visual Studio 2008を使用してsetupプロジェクトを作成する際，インストーラがユーザードキュメントフォルダ（ユーザーの個人用データフォルダ）
にフォルダまたはファイルの配置を試みると，オペレーティングシステムに依存して以下に示す挙動を示す。<p>
インストーラはインストール時，またはインストールしたプログラムの初回起動時に以下のフォルダ，ファイルの生成を試みる。<br>
<ul>
<li>＜ユーザードキュメントフォルダ＞\StkFw
<li>＜ユーザードキュメントフォルダ＞\StkFw\SampleData
<li>＜ユーザードキュメントフォルダ＞\StkFw\SampleData\*.* （＜インストール先＞\StkFw\sample内のファイルがコピーされる）
</ul><br>
しかし，実際に生成されるかどうかはOSにより異る。<br>
<table class="tblstyle">
<tr><td>OS</td><td>Administratorsのユーザー（インストールしたユーザー）</td><td>Administratorsの他のユーザー</td><td>Usersのユーザー</td><td>Guestのユーザー</td></tr>
<tr><td>Windows2000</td><td>◎</td><td>×</td><td>○</td><td>○</td></tr>
<tr><td>WindowsXP</td><td>◎</td><td>×</td><td>○</td><td>○</td></tr>
<tr><td>WindowsServer2003</td><td>◎</td><td>×</td><td>－</td><td>－</td></tr>
<tr><td>WindowsVista</td><td>◎</td><td>○</td><td>○</td><td>○</td></tr>
<tr><td>WindowsServer2008</td><td>◎</td><td>○</td><td>○</td><td>○</td></tr>
<tr><td>Windows7</td><td>◎</td><td>○</td><td>○</td><td>○</td></tr>
</table>
◎：インストール時にフォルダ/ファイルが生成される<br>
○：インストールしたプログラムの初回起動時にフォルダ/ファイルが生成される<br>
×：インストールしたプログラムは起動できるがフォルダ/ファイルは生成されない<br>
－：インストールしたプログラムの初回起動時にエラー（デジタル署名ポリシー違反）が発生し，フォルダ/ファイルが生成されない<br>
<p>
上記の例は，インストールしたユーザーのデスクトップ上にインストール元ファイルであるsetup.exe，XXXX.msiを残したままにしたときの挙動である。<br>
インストール直後にsetup.exe，XXXX.msiを削除した場合の挙動を以下に示す。<br>
<table class="tblstyle">
<tr><td>OS</td><td>Administratorsのユーザー（インストールしたユーザー）</td><td>Administratorsの他のユーザー</td><td>Usersのユーザー</td><td>Guestのユーザー</td></tr>
<tr><td>Windows2000</td><td>◎</td><td>×</td><td>△</td><td>△</td></tr>
<tr><td>WindowsXP</td><td>◎</td><td>×</td><td>△</td><td>△</td></tr>
<tr><td>WindowsServer2003</td><td>◎</td><td>×</td><td>△</td><td>△</td></tr>
<tr><td>WindowsVista</td><td>◎</td><td>△</td><td>△</td><td>△</td></tr>
<tr><td>WindowsServer2008</td><td>◎</td><td>△</td><td>△</td><td>△</td></tr>
<tr><td>Windows7</td><td>◎</td><td>△</td><td>△</td><td>△</td></tr>
</table>
◎：インストール時にフォルダ/ファイルが生成される<br>
△：インストールしたプログラムの初回起動時にXXXX.msiの場所の指定を促すメッセージが表示される<br>
×：インストールしたプログラムは起動できるがフォルダ/ファイルは生成されない<br>
</div><p>

<h3><b><u>メモリリーク検出用デバッグコード</u></b></h3>
<div class="topic">
Visual C++を使用したソフトウェア開発において，メモリリークを発生させるコードは気を付けていても
作り込まれてしまうもの。これはC/C++の宿命のようなものであるが，メモリリークの要因は，メモリリーク
検出用のデバッグコードを埋め込むことにより，容易に取り除くことができる。<p>
<ol>
<li>メモリリークが疑われるソースコードの先頭行に以下の宣言文を追加する。<br>
<div class="topic">
#define _CRTDBG_MAP_ALLOC<br>
#include &#60;stdlib.h&#62;<br>
#include &#60;crtdbg.h&#62;<br>
#define new  ::new(_NORMAL_BLOCK, __FILE__, __LINE__)<br>
</div>
<li>メモリリークの候補をDUMPする。
<div class=topic>
OutputDebugString(_T("Dump memory leaks"));<br>
_CrtDumpMemoryLeaks();<br>
</div><p>
</ol>
Visual C++からデバッグモードでプログラムを起動すると，上記#2のDUMP情報がVisual C++のコンソールに出力される。
出力される情報は下記のとおり。<br>
<ul>
<li>メモリ割り当て番号 (中括弧に囲まれた数字) 
<li>ブロックの型 (Normal、Client または CRT) 
<li>16 進数で表されるメモリの位置 
<li>バイト単位で表されるブロックのサイズ 
<li>先頭の 16 バイトの内容 (16 進数)
</ul>
<code>
c:\work\github\yaizucomlib\src\commonfunc\stkobject.cpp(716) : {3539} normal block at 0x00AB4CE8, 32 bytes long.<br>
 Data: &lt;HM       M      &gt; 48 4D AB 00 16 00 00 00 90 4D AB 00 00 00 00 00 <br>
</code>
<br/>
OutputDebugStringおよび_CrtDumpMemoryLeaksのみでもDUMP情報は出力されるが，前述#defineおよび#includeを挿入することにより，
ソースコードのファイル名とメモリ確保を行った行番号が出力される。<br/>
</div><p>

<h3><b><u>WM_INITDIALOGのプラットフォーム毎の挙動：注意事項</u></b></h3>
<div class="topic">
ダイアログ表示に関するプラットフォーム挙動差異：
DialogBox()を使用してダイアログを作成する。<br>
<ul>
<li>WM_INITDIALOGをハンドルして(INT_PTR)TRUEを返す<br>
	Windows XPではダイアログが表示される<br>
	Windows 2000でもダイアログが表示される<br>
<li>WM_INITDIALOGをハンドルしない<br>
	Windows XPではダイアログが表示される<br>
	Windows 2000ではダイアログが表示されない<br>
</ul>
List Control（レポート属性）に関するプラットフォーム挙動差異：
DialogBox()を使用してList Control（レポート属性）付きダイアログを作成する。<br>
<ul>
<li>WM_INITDIALOGでImageList_Create()を呼び出している。<br>
	Windows XPではダイアログが表示される<br>
	Windows 2000でもダイアログが表示される<br>
<li>WM_INITDIALOGでImageList_Create()を呼び出していない。<br>
	Windows XPではダイアログが表示される<br>
	Windows 2000ではダイアログが表示されない<br>
</li>
</ul>
</div><p>

<h3><b><u>C++ オーバーライド不可の指定</u></b></h3>
<div class="topic">
virtual関数を派生先でオーバーライド不可にすることはC++ではできない。<br>
JAVAではfinal，C#ではsealdを使用することにより，オーバーライド不可にすることができる。
</div><p>

<h3><b><u>Pimplイディオム</u></b></h3>
<div class="topic">
C++でライブラリの開発をしていると，ヘッダファイルにインターフェース以外の実装が含まれるのを回避したいと考えるときがある。
そのような実装部は，呼び出し側のユーザープログラムにとっては，知る必要の無い事項／知っていてはいけない事項であり，これを如何に
暴露させないかはシンプルなインターフェースを提供する上で重要なことである。<br>
Pimplイディオムの実装は色々なやり方があるが，手っ取り早いのは下記の定義をクラスに記述し，実装部をcpp内のImplクラスに
押し込むやり方。<p>
private:<br>
<div class="topic">
  class Impl;<br>
  Impl* pImpl_;<br>
</div>
<p>もとのクラスのコンストラクタでImplインスタンスを生成し，デストラクタでImplインスタンスを消滅させるコードを記述する。</p>
</div><p>

</div>
</div>


<p>
<hr>
<div class="base">
<u id="devkloc">開発規模について</u><BR>
<div class="topic">
開発したソフトウェアの規模の推移を以下にまとめた。<p>
<h3><u>StkFw 1.0.0 (2008.12.19 ﾘﾘｰｽ) 開発規模 : 9,259</u></h3>
<div class=topic>
<table class="tblstyle">
<tr><td>StkAbout</td><td>228</td></tr>
<tr><td>Stk_IP_DLG</td><td>843</td></tr>
<tr><td>StkData</td><td>2,864</td></tr>
<tr><td>StkLib</td><td>2,994</td></tr>
<tr><td>StkThread</td><td>730</td></tr>
<tr><td>StkFw</td><td>1,600</td></tr>
</table>
</div><BR>
<h3><u>StkFw 1.1.0 (2009.12.14 ﾘﾘｰｽ) 開発規模 : 15,382</u></h3>
<div class=topic>
<table class="tblstyle">
<tr><td>StkAbout</td><td>228</td></tr>
<tr><td>Stk_IP_DLG</td><td>954</td></tr>
<tr><td>StkData</td><td>3,195</td></tr>
<tr><td>StkLib</td><td>3,018</td></tr>
<tr><td>StkThread</td><td>743</td></tr>
<tr><td>StkFw</td><td>2,108</td></tr>
<tr><td>LBAadpt</td><td>187</td></tr>
<tr><td>MessageProc</td><td>332</td></tr>
<tr><td>FwAdd/FwDel</td><td>36</td></tr>
<tr><td>VarCon</td><td>1,328</td></tr>
<tr><td>StkProp</td><td>3,253</td></tr>
</table>
</div><BR>
<h3><u>StkFw 1.2.0 (2010.06.28 ﾘﾘｰｽ) 開発規模 : 17,013</u></h3>
<div class=topic>
<table class="tblstyle">
<tr><td>Common/StkAbout</td><td>241</td></tr>
<tr><td>Common/StkData</td><td>3,656</td></tr>
<tr><td>Common/MessageProc</td><td>478</td></tr>
<tr><td>Common/StkThread</td><td>794</td></tr>
<tr><td>Stk_IP_DLG</td><td>996</td></tr>
<tr><td>StkLib</td><td>2,998</td></tr>
<tr><td>StkFw</td><td>7,601</td></tr>
<tr><td>LBAadpt</td><td>213</td></tr>
<tr><td>FwAdd/FwDel</td><td>36</td></tr>
</table>
</div><BR>
<h3><u>StkFw 1.3.0 (2011.04.25 ﾘﾘｰｽ) 開発規模 : 19,893</u></h3>
<div class=topic>
<table class="tblstyle">
<tr><td>Common/StkAbout</td><td>236</td></tr>
<tr><td>Common/StkData</td><td>2,253</td></tr>
<tr><td>Common/StkDataGui</td><td>1,054</td></tr>
<tr><td>Common/MessageProc</td><td>552</td></tr>
<tr><td>Common/StkThread</td><td>822</td></tr>
<tr><td>Stk_IP_DLG</td><td>857</td></tr>
<tr><td>StkLib</td><td>3,018</td></tr>
<tr><td>StkFw</td><td>8,276</td></tr>
<tr><td>LBAadpt(コマンド含む)</td><td>2,789</td></tr>
</table>
</div><BR>
<h3><u>StkFw 1.4.0 (2013.02.27 ﾘﾘｰｽ) 開発規模 : 25,638</u></h3>
<div class=topic>
<table class="tblstyle">
<tr><td>Common/StkAbout</td><td>236</td></tr>
<tr><td>Common/StkData</td><td>2,389</td></tr>
<tr><td>Common/StkDataGui</td><td>1,079</td></tr>
<tr><td>Common/MessageProc</td><td>895</td></tr>
<tr><td>Common/StkThread</td><td>529</td></tr>
<tr><td>Common/StkThreadGui</td><td>614</td></tr>
<tr><td>Common/StkSocket</td><td>706</td></tr>
<tr><td>Stk_IP_DLG</td><td>857</td></tr>
<tr><td>StkLib</td><td>2,916</td></tr>
<tr><td>StkFw</td><td>8,852</td></tr>
<tr><td>LBAadpt(コマンド含む)</td><td>2,789</td></tr>
<tr><td>CmdFreak</td><td>1,367</td></tr>
</table>
</div><BR>
<h3><u>CmdFreak 1.0.0 (2014.02.04 ﾘﾘｰｽ) 開発規模 : 25,814</u></h3>
<div class=topic>
<table class="tblstyle">
<tr><td>Common/StkAbout</td><td>236</td></tr>
<tr><td>Common/StkData</td><td>2,389</td></tr>
<tr><td>Common/StkDataGui</td><td>1,198</td></tr>
<tr><td>Common/MessageProc</td><td>847</td></tr>
<tr><td>Common/StkThread</td><td>529</td></tr>
<tr><td>Common/StkThreadGui</td><td>614</td></tr>
<tr><td>Common/StkSocket</td><td>706</td></tr>
<tr><td>Stk_IP_DLG</td><td>857</td></tr>
<tr><td>StkLib</td><td>2,916</td></tr>
<tr><td>StkFw</td><td>8,852</td></tr>
<tr><td>LBAadpt(コマンド含む)</td><td>2,789</td></tr>
<tr><td>cmdfrksrv</td><td>1,749</td></tr>
<tr><td>bbb</td><td>1,438</td></tr>
</table>
</div><BR>
<h3><u>StkFw 1.5.0 (2015.12.10 ﾘﾘｰｽ) 開発規模 : 26,841</u></h3>
<div class=topic>
<table class="tblstyle">
<tr><td>CommonLib</td><td>6,855</td></tr>
<tr><td>StkFw</td><td>16,128</td></tr>
<tr><td>CmdFreak</td><td>3,858</td></tr>
</table>
</div><BR>
<h3><u>CmdFreak 1.1.0 (2018.01.28 ﾘﾘｰｽ) 開発規模 : 29,183</u></h3>
<div class=topic>
<table class="tblstyle">
<tr><td>CommonLib</td><td>9,520</td></tr>
<tr><td>StkFw</td><td>16,398</td></tr>
<tr><td>CmdFreak</td><td>3,265</td></tr>
</table>
</div><BR>
</div>
</div>


<p>
<hr>
<div class="base">
<u id="versionrule">バージョン表記に関する規約</u><BR>
<div class="topic">
開発ソフトウェアのバージョン表記は以下の様に, メジャーバージョン番号, マイナーバージョン番号, 不良修正番号
をピリオド "." で区切った形式とする。<BR>
例）1.6.4<BR>
<div class=topic>
メジャーバージョン番号 = 1<BR>
マイナーバージョン番号 = 6<BR>
不良修正番号 = 4<BR>
</div><BR>
<UL>
<LI>メジャーバージョン番号： 常に1。
<LI>マイナーバージョン番号： エンハンスの度に値を上げる。
<LI>不良修正番号： 不良のみを修正した場合値を上げる。
</UL>
</div>
</div>


<p>
<hr>
<div class="base">
<u id="network">ネットワーク環境</u><BR>
<div class="topic">
各物理PC/仮想PCの役割は以下のとおり。<BR>
<TABLE class="tblstyle">
<TR>
	<TD>SHINY-pc</TD>
	<TD>DHCP</TD>
	<TD>ソフトウェア開発用。ASUSのラップトップPC。</TD>
</TR>
<tr>
	<td>n-win7-c3f9c</td>
	<td>DHCP</td>
	<td>ソフトウェアテスト用<br/>CPU: 1 (x64), Mem: 4,096MB, HDD: 60GB, Network: ブリッジ</td>
</tr>
<tr>
	<td>n-win2008-h7tdv</td>
	<td>DHCP</td>
	<td>ソフトウェアテスト用<br/>CPU: 1 (x64), Mem: 4,096MB, HDD: 50GB, Network: ブリッジ</td>
</tr>
<tr>
	<td>n-win2016-q3rnc</td>
	<td>DHCP</td>
	<td>ソフトウェアテスト用<br/>CPU: 1 (x64), Mem: 4,096MB, HDD: 80GB, Network: ブリッジ</td>
</tr>
</TABLE>
</div>
</div>


<p>
<hr>
<div class="base">
<u id="usedport">使用ポート番号</u><BR>
<div class="topic">
リリースしたソフトウェアやテストコードがデフォルトで使用するポート番号を以下に整理する。<BR>
<TABLE class="tblstyle">
<tr><th>ソフトウェア名称</th><th>IPアドレス</th><th>ポート番号</th></tr>
<tr><td>CmdFreak 1.0.0 (HTTPサーバ)</td><td>-</td><td>8008</td></tr>
<tr><td>CmdFreak 1.0.0 (CmdFreakサービス)</td><td>localhost</td><td>2002</td></tr>
<tr><td>YaizuSample (HTTPサーバ)</td><td>localhost</td><td>80</td></tr>
<tr><td>YaizuSample (REST APIサービス)</td><td>localhost</td><td>8081</td></tr>
<tr><td>StkWebAppTest</td><td>127.0.0.1</td><td>8080, 8081, 8082, 8083</td></tr>
<tr><td>StkSocketTest (IPv4-TCP)</td><td>127.0.0.1</td><td>2001, 2000～2039, 2100, 2201～2203, 2221～2225, 3000～3039</td></tr>
<tr><td>StkSocketTest (IPv4-UDP)</td><td>127.0.0.1</td><td>2001, 2002, 2003</td></tr>
<tr><td>StkSocketTest (IPv6-TCP)</td><td>::1</td><td>2202</td></tr>
<tr><td>StkSocketTest (IPv6-UDP)</td><td>::1</td><td>2202</td></tr>
</TABLE>
</div>
</div>


<p>
<hr>
<div class="base">
<u id="backup">バックアップ方法</u><BR/>
<div class="topic">
ローカルファイルのバックアップは，下図のように複数のメディアを組み合わせる形で多重にバックアップを行う。<BR/>
<img src="backup.gif" alt="Backup"><br/>
ローカルディスク: Dドライブ<br/>
USBメモリ: Fドライブ<br/>
SDカード: Gドライブ<br/>
OneDrive: C:\Users\Shinya\OneDrive<br/>
</div>
</div>


<p>
<hr>
<div class="base">
<u id="takeuchi-xxx">VPS [takeuchi-xxx.com]</u><BR>
<div class="topic">
開発サーバとしてDebianの後を継ぎ運用開始。株式会社日本システム開発のWinServerと一年契約。<br>
<table class="tblstyle">
<tr><td>初期費用</td><td>￥3,000</td></tr>
<tr><td>ドメイン取得または移転料</td><td>￥3,500</td></tr>
<tr><td>Lightプラン 12ヶ月分</td><td>￥21,600</td></tr>
<tr><td>消費税</td><td>￥1,405</td></tr>
<tr><td>合計</td><td>￥29,505</td></tr>
</table><p>
VPSの設定<br>
<div class=topic>
<ol>
<li>Administratorのパスワードを変更
<li>運用ユーザーtakeuchiの追加
<li>コントロールパネル - デザイン - フォルダオプションで登録済拡張子を表示するように変更
<li>サーバーマネージャでIE ESCの構成を変更
<li>C:\publicに共有フォルダを作成する
</ol>
</div>
Trac Lightningインストールおよび準備<br>
<div class=topic>
<ol>
<li>Trac Lightning 3.0.8をインストール, subversion, tracのみインストール
<li>trac->サービスのインストール
<li>Trac Lightningのサービスを手動で起動
<li>"セキュリティが強化されたWindowsファイアウォール"で受信の規則としてポート#80を許可にする
<li>OS再起動
<li>OS再起動後Trac Lightningのサービスが自動で起動されていることを確認
<li>SampleProjectのデフォルトで登録されているadmin, guest, leaderのパスワードを変更
</ol>
</div>
以前のプロジェクトの移管<br>
Debianで運用していたsvnおよびtracのプロジェクトをtakeuchi-xxx.comに移管する手順を示す。<br>
移管後のプロジェクト名をBambooProjectとする。<br>
<div class=topic>
<ol>
<li>svnおよびtracにプロジェクトを作成する  "create-project.bat BambooProject"
<li>svnに移管前のプロジェクトのデータをインポートする  "svnadmin load C:\TracLight\projects\svn\BambooProject &lt; c:\public\svnbkup.dump"
<li>Trac Lightningのサービスを停止する
<li>tracに移管前のプロジェクトのデータを配置する(まるごとコピーする)
<li>trac.ini(C:\TracLight\projects\trac\BambooProject\conf\trac.ini)のrepository_dirを"C:\TracLight\projects\svn\BambooProject"に変更する
<li>Trac Lightningのサービスを開始する
<li>移行前ver=0.11，移行後ver=0.12のためデータのUpgradeを実行する  "trac-admin C:\TracLight\projects\trac\BambooProject upgrade"
<li>tracとsvnの同期を行う  "trac-admin C:\TracLight\projects\trac\BambooProject repository resync "*""
<li>tracにログインし[管理]-[一般設定]-[基本設定]-[名称]="BambooProject", [URL]="http://www.takeuchi-xxx.com/trac/BambooProject/"に変更
<li>tracにログインし[管理]-[一般設定]-[プラグイン]で以下を有効にする<br>
iniadmin 0.2 [全てのコンポーネント]<br>
tracaccountmanager 0.2.1dev [全てのコンポーネント]<br>
tracusermanagerplugin 0.4r5520 [全てのコンポーネント]<br>
<li>trac.iniのaccount_managerを変更<br>
[htdigest_realm=trac]<br>
[password_format=htdigest]<br>
[password_file=C:\TracLight\projects/trac.htdigest]<br>
[password_store=HtDigestStore]<br>
<li>[管理]-[アカウント]-[ユーザ]でユーザーを編集する
<li>[管理]-[一般設定]-[権限]でアクセス権限を編集する
<li>サービス停止後，"trac\BambooProject\db"フォルダ以外のフォルダ／ファイルをすべて削除し，"\tarc\SampleProject"からコピーする
<li>"trac\BambooProject\conf\trac.ini"を編集する<br>
※重要：trac.iniを編集するときはワードパッドを使用する。<br>
※メモ帳で編集した場合，不正なエラーが発生しTracにログインできなくなる。<br>
- 全ての"SampleProject"の記述を"BambooProject"に変更する<br>
- "tickets.href = /wiki/MyTickets"を"tickets.href = /report"に変更する。<br>
- "complete.label","due_assign.label","due_close.label","parents.label"を変更(英語化)<br>
- Ticket workflowについても変更(英語化)<br>
<li>サービスを開始する。必要に応じてResyncを実行する。
</ol>
</div>
テスト管理用プラグインの導入<br>
Tracのテスト管理用プラグインであるTestManagerForTracの導入手順を以下に示す。
<div class=topic>
testman4trac.1.7.1-Py_2.6-Trac_0.12-1.0.zip を解凍し，下記の順でeggファイルをtracにインストールする。
インストールはtracのGUIから可能。<br>
<ul>
<li>TracGenericClass-1.1.5-py2.6.egg<br>
<li>TracGenericWorkflow-1.0.4-py2.6.egg<br>
<li>TestManager-1.7.1-py2.6.egg<br>
</ul>
TracGenericWorkflow-1.0.4-py2.6.eggおよびTestManager-1.7.1-py2.6.eggのインストール後にはtracのupdateが必要。<p>
</div>
2012年5月から利用していたVPSの契約を2015年5月で解除。<br>
チケット管理システムをGitHubに移行。<br>
</div>
</div>


<p>
<hr>
<div class="base">
<u id="kurosheeva">玄人志向 KURO-SHEEVA: ホスト名=Debian</u><BR>
<div class="topic">
製品名称： KORO-SHEEVA<br>
購入日： 2010/10/26<br>
経緯： 上野科学博物館で開催されていた「空と宇宙展」に行った帰りに衝動買いしたもの。
subversionやtracのような開発支援用サーバとして機能させたいと考えていた。<br>
価格： \16,800 (T-ZONE PC DIY SHOPにて)<br>
<img src="kurosheeva.jpg" alt="KURO Sheeva">
<p>
型番 KURO-SHEEVA<br> 
JANコード 4988755233545<br>
ハードウェア仕様<br>
<div class=topic>
	MPU：<br>
	Marvell Sheeva CPUコア搭載<br>
	Kirkwood SoCプロセッサ 88F6281 (1.2GHz)<br>
	メインメモリ：512MB/DDR2<br>
	NANDフラッシュメモリ：512MB<br>
</div>
インターフェース<br>
<div class=topic>
	LAN(RJ45/1000BASE-T)x1<br>
	USB2.0/1.1(TYPE A)x1<br>
	USB1.1(TYPE miniB)x1※<br>
	SDスロットx1, eSATAx1<br>
	※コンソール用<br>
</div>
搭載OS Ubuntu 9.04
(内蔵NANDフラッシュメモリ内にインストール済み)<br>
消費電力 最大約11W<br>
外形寸法 96.5x110x48.5mm(突起部除く)<br>
付属品<br>
<div class=topic>
USB-miniUSBケーブル<br>
LANケーブル<br>
ACケーブル<br>
</div><p>
新規導入手順<br>
<div class=topic>
<ol>
<li>接続元PCへのUSBドライバのインストール。（USBケーブルを接続→ドライバの場所を指定）
<li>Tera Termから接続の確認 (ポートレート = 115200)
<li>passwdコマンドでパスワードの設定
<li>dpkg-reconfigure tzdataコマンドでタイムゾーンの設定
<li>dateコマンドで日時の設定
<li>/etc/network/interfaces の編集によるIPアドレスの設定
<li>/etc/resolv.conf の編集によるDNSの設定
<li>apt-get install ftpd でFTPのインストール
<li>mke2fs /dev/mmcblk0p1 でext2フォーマット
<li>/etc/fstab の編集によるSDカードの自動マウント (/dev/mmcblk0p1 /media/sdcard ext2 defaults 0 0)
<li>/etc/smb.confの[Media]または[global]を編集する。<br/>
comment = Media<br/>
path = /media/sdcard/public<br/>
public = no<br/>
guest ok = no<br/>
valid users = @takeuchi<br/>
security = user<br/>
<li>useraddおよびpdbedit -aを用いてユーザーを追加する。
<li>sambaの有効化 (/etc/rc.local に /etc/init.d/samba start を追記)
</ol>
</div>
Subversion導入手順<br>
<div class=topic>
<ol>
<li> apt-get install apache2
<li> apt-get install subversion
<li> apt-get install libapache2-svn
<li> chmod 777 /tmp, chmod 777 /var/tmp でsubversionのプロセスが/tmp, /var/tmpに書き込めるようにする
<li> /etc/apache2/mods-available/dav_svn.conf の編集
<li> svnadmin create --fs-type fsfs MyNewRepository
<li> chown -R www-data:www-data MyNewRepository で所有権変更
<li> apache2ctl restart
</ol>
</div>
Trac導入手順<br>
<div class=topic>
<ol>
<li> apt-get install trac
<li> mkdir /media/sdcard/trac
<li> trac-admin trac initenv
<li> chown -R www-data:www-data trac で所有権変更
<li> apt-get install libapache2-mod-python
<li> htpasswd -c /media/sdcard/trac/htdocs/trac.htpasswd takeuchi によるユーザーの作成
<li> /etc/apache2/conf.d/trac.conf の新規作成と編集
<li> trac-adminによるpermissionの設定 "TRAC_ADMIN"
<li> apache2ctl restart
</ol>
</div>
Subversion-Trac連携手順<br>
<div class=topic>
<ol>
<li>trac-post-commit-hookを/media/sdcard/takeuchi/hooksにコピーする
(http://trac.edgewall.org/browser/branches/0.11-stable/contrib/)
<li>/media/sdcard/takeuchi/hook/post-commit.tmpl を post-commit にコピーし編集する
<li>chown でスクリプトの所有権をwww-data に変更
<li>chmod 755 post-commit で実行権限を付与
</ol>
</div>
Subversion, Tracバックアップ手順<br>
<div class=topic>
<ul>
<li>svnadmin dump /media/sdcard/takeuchi > /media/sdcard/svnbkup.dump
<li>trac-admin /media/sdcard/trac hotcopy /media/sdcard/tracbkup
<li>tar -cvf /media/sdcard/tracbkup.tar /media/sdcard/tracbkup
</ul>
</div>
<p>
Debian(KURO-SHEEVA)不具合のため運用終了 (2012/05/13)<br>
Debian(KURO-SHEEVA)運用終了。5/13より処分開始。<br>
経緯： 開発用で使用していたが，頻繁に不具合(熱暴走)が発生したため，機能をVPSに移管しKURO-SHEEVAは運用を終了する。<br>
<img src="kurosheeva2.jpg" alt="KURO Sheeva"><br/>
2017年2月頃，不燃ゴミとして滅却処分済。<br/>
<img src="kurosheeva3.jpg" alt="KURO Sheeva"><br/>
</div>
</div>


<p>
<hr>
<div class="base">
<u id="sublina">サブPC: ホスト名=Sublina</u><BR>
<div class="topic">
サブPCとしてケース, CPU, HDD, メモリ，マザーボードを購入。詳細は下記の構成。<br/>
ホスト名はSublinaとした。<br/>
購入日=2010/10/26。<br/>
<ul>
<li>CPU: AMD Phenom II X6 1055T<br>2.8GHz, 3.3GHz(TurboCore)<br>9.0MB Total Cache
<li>マザーボード: MINIX 6150SE-UC3<br>NVIDIA GeForce 6150SE<br>nForce 430MCP<br>
<li>メモリ: 2GB×2
AMD Socket AM3 95W Max<br>Dual Channel DDR3 1333/1066/800 MHz
<li>HDD: HDP725032GLA360 320GB
<li>OS: Windows Server 2008
</ul>
<img src="sublina2.jpg" alt="Sublina">
<p>
SublinaのOS入れ替えを実施 (2011/6/1)<BR>
OSの入れ替えを実施。NecoのバックアップPCとする。<br/>
<ul>
<li>OS: Windows 7 Ultimate
</ul>
<p>
Sublinaの運用停止 (2013年頃?)<br>
<ul>
<li>稼働率が低いため，運用を停止し，物置に移動した。
</ul>
</div>
</div>


<p>
<hr>
<div class="base">
<u id="neco">NECのPC: ホスト名=Neco</u><BR>
<div class="topic">
<h2>Necoの購入 (2005/8/??)</h2>
秋葉原のLAOXにてPCおよび液晶ディスプレイを購入。<br>ホスト名はNecoとした。<br>
<ul>
<li>型名: NEC ValueOne MT (MT600/2A)
<li>本体サイズ: 175（幅）×420（奥行き）×381（高さ）ミリ
<li>出荷日: 2005年8月25日
<li>OS: Microsoft(R) Windows(R) XP Home Edition 日本語版 Service Pack 2
<li>CPU: HTテクノロジ　インテル(R) Pentium(R) 4プロセッサ 2.80GHz 521<br/>
(FSB=800MHz Prescott L2-cache=1MB EMT64)
<li>メモリ: DDR2-533MHz/ 256Mバイト(DDR2 SDRAM PC2-4200 DIMM)×2
<li>サウンド: ADI社製 AD1981B搭載（不明）
<li>HDD: <br>Serial ATA 7200回転／分 160GB
<li>チップセット: <br/>
945G (82945G)<br>
  - 最大メモリ容量 4GB (最大大域幅 10.7GB/s)<br>
  - デュアル・チャネル DDR2 メモリー<br>
  - 1066/800 MHz システムバス<br>
  - PCI Express* x16 グラフィックス・ポート<br>
  - PCI Express x1 I/O ポート<br>
  - 次世代のシリアル ATA (SATA) 3Gb/s<br>
  - Hi-Speed USB 2.0 接続<br>
  - GMA 950 グラフィックス・コアを内蔵<br>
82801GR (South Bridge)<br>
  - I/O コントローラー・ハブ (ICH7R)<br>
<li>DVD/CD: <br/>
  - DVDスーパーマルチドライブ (DVD-RAM/R/RW with DVD+R/RW)<br>
  - バッファアンダーランエラー防止機能付<br>
  - DVD-R/+R 2層書き込み<br>
  - HL-DT-ST DVDRAM_GSA-4165B<br>
  - サポートOS:<br>
  Windows 98, Windows ME, Windows 2000 Professional, 
  Windows XP Home Edition, Professional, Media Center Edition<br>
  - 対応フォーマット:<br>
  記録：DVD-RAM, DVD-R/RW, DVD+R (SL, DL)/RW, CD-R/RW<br>
  再生：DVD-ROM, DVD-RAM, DVD-R, DVD-RW, DVD+R (SL, DL), 
  DVD+RW; CD-R, CD-RW, CD-ROM, CD-ROM XA, <br>
  CD-DA, CD-I, CD-Extra, CD-Text, Photo CD, Video CD<br>
  ---以下補足---<br>
  標準CD-ROM関連     [読込倍速] DVD-RAM最大5倍速、DVD最大16倍速、CD最大40倍速<br>
  標準CD-ROM関連     [書込倍速] DVD-RAM最大5倍速、DVD-R(1層)/+R(1層)最大16倍速、DVD-R(2層)/+R(2層)最大4倍速、DVD-RW最大6倍速、DVD+RW最大8倍速、CD-R最大40倍速、CD-RW最大10倍速<br>
<li>BIOS: <br>American Megatrends, Inc. v.02.58
<li>マザーボード: <br>microATX MSI製 MS-7186
</ul>
<img src="neco.jpg" alt="NECO"><br>
<p>
<h2>Necoのメモリを拡張(メモリの入れ替え)を実施 (2008/1/1)</h2>
<ul>
<li>メモリ: <br/>
PC533 CL4 DDR2 1GB (Windows XP Pro SP2 DSP版)<br>
PC533 CL4 DDR2 1GB (Windows XP Pro SP2 DSP版)<br>
PC667 DDR2 512MB (Windows Vista Business DSP版)<br>
PC667 DDR2 512MB (Windows Vista Business DSP版)<br>
</ul>
<p>
<h2>NecoのHDDを拡張(HDDの入れ替え)を実施 (2009/1/1)</h2>
<ul>
<li>HDD: HDP725032GLA360 (容量:320GB,回転数:7200rpm,キャッシュ:16MB,I/F:Serial-ATA300)<br/>
 (2008/5/5購入, \6300)
</ul>
<p>
<h2>Necoのマザーボード/CPU/メモリを拡張 (2011/6/1)</h2>
下記の構成に変更<br/>
<ul>
<li>CPU: Intel Core2Quad Q6600<br>クロック：2.4GHz<br>Ｌ２キャッシュ：8MB<br>ＦＳＢクロック：1066MHz
<li>マザーボード: Intel Desktop Board  Classic Series DG31PR<br>
LGA775 soket for Intel Core2Quad, Core2Duo, Pentium Dual-Code, Celeron400<br>
Intel G31 Express Chipset<br>
Realtek ALC888 audio codec<br>
Graphics Media Accelerator X3100<br>
DDR2 800 / 667 SDRAM (Max 4GB)<br>
<li>メモリ: Dual DDR2-800 KINGBOX 2GB×2
<li>HDD: Hitachi HDS721050CLA362 500GB
<li>サウンドカード: Sound Blaster 5.1 VX (PCI) 
<li>OS: Windows 7 Ultimate
</ul>
<img src="sublina.jpg" alt="Sublina"><br>
<p>
Necoに搭載のMBのマニュアル：<BR>
Intel製マザーボード DG31PRのマニュアル・その他を処分した。念のためマザーボードのマニュアル(一部)の写真を撮って残しておくことに。
<img src="dg31pr.jpg" alt="Mother board"><br>
Neco購入時のMBは，2017年2月頃，不燃ゴミとして滅却処分済。<br/>
<img src="neco1.jpg" alt="NECO"><br/>
<p>
<h2>購入したときのHDDの増設の実施 (2013/6/8)</h2>
<ul>
<li>(Serial ATA 7200回転／分 160GB)<br>
重要ファイルのバックアップ／スナップショット格納先として使用予定。
</ul>
<p>
<h2>NECOの運用停止 (2015/6/13)</h2>
<ul>
<li>2015年6月，ASUSのノートPCを購入したことにともない，NECOの運用を停止。<br>
物置にて廃棄待ちの状態とした。<br>
<li>PCケース/電源については，2005年から概ね10年間の運用。マザーボードについては2011年にリプレースを実施して以降4年間の運用。
</ul>
<img src="oldpcs_s.jpg" alt="NECO"><br>
<h2>運用再開 (2016/12/26)</h2>
<p>
後述するASUSのノートPCの障害のため，2016年12月26日からNECOの運用を再開。<br/>
物理マシンにインストールするソフトウェアの見直しを実施。以下インストール済ソフトウェア一覧。<br/>
</p>
<ul>
<li>Canon MG6130 プリンタドライバ
<li>Creative Sound Blasterドライバ
<li>Microsoft Office 2010
<li>Adobe Reader 最新版
<li>Adobe Flash Player 最新版
<li>Visual Studio 2008 Professional Edition (with patch "VS90-KB948127.exe")
<li>wkhtmltopdf 0.12.0.3
<li>PDFtk Server 2.02
<li>7-Zip 9.20
<li>Line Counter 1.4
<li>SourceTree 最新版
<li>GIMP 2.8
<li>Microsoft Security Essentials
<li>FFFTP 1.98g
<li>e frontier Shade 13
<li>VMware Player 最新版
<li>PIXELA VideoBrowser + 最新パッチ
<li>Abyssmedia Wave Editor 3.3.5.1
<li>Firefox 最新版
</ul>
<p>
<h2>2回目の運用停止 (2017/3/25)</h2>
<p>
SHINYA-PCの復旧に伴い，NECOの運用を再度停止した。
</p>
</div>
</div>


<p>
<hr>
<div class="base">
<u id="shinyapc">ASUSのノートPC: ホスト名=SHINYA-PC</u><BR>
<div class="topic">
<h2>SHINYA-PC購入 (2015/6/13)</h2>
<p>
NECOの性能が近年のソフトウェア開発環境についていけなくなったため，NECOの後釜として購入 (2015/6/13)。<br/>
</p>
<ul>
<li>ASUS X751L<br>
CPU: Intel Core i7-5500U, Up to 3.0GHz (2 Cores, 4 Threads)<br>
Memory: 8GB<br>
HDD: 1TB<br>
<li>ソフトウェア開発のメインマシンとして活用する。<br>
<li>2015/6/20にNECOからの移行作業完了。<br>
<li>既存のノートPC"AKEMI-PC"と対比させるため，マシン名を"SHINYA-PC"とした。<br>
<li>2015/8/15にWindows 10へのアップグレードを実施。<br>
</ul>
<p>
<img src="shinyapc_s.jpg" alt="ASUS PC"><br>
<p>
物理マシンにインストールするソフトウェアは下記のとおり。<br>
<ul>
<li>VMware Player 最新版
<li>Wave Editor 3.3.4.0
<li>PIXELA VideoBrowser + 最新パッチ
</ul>
ソフトウェア開発環境はVMwareのゲストOS(Windows 7 Ultimate)に構築。仮想マシンにインストールするソフトウェアは下記のとおり。<br>
<ul>
<li>Canon MG6130 プリンタドライバ
<li>Microsoft Office 2010
<li>Adobe Reader 最新版
<li>Adobe Flash Player 最新版
<li>Visual Studio 2008 Professional Edition (with patch "VS90-KB948127.exe")
<li>wkhtmltopdf 0.12.0.3
<li>PDFtk Server 2.02
<li>7-Zip 9.20
<li>Line Counter 1.4
<li>SourceTree 1.6
<li>GIMP 2.8
<li>Ineternet Explorer 最新版
<li>Firefox ESR 最新版
<li>Chrome 最新版
<li>Microsoft Security Essentials
<li>FFFTP 1.98g
</ul>
<h2>SHINYA-PC故障 (2016/12/20)</h2>
<p>
2016年12月17日あたりから，Windows 10のディスクアクセス負荷が100%を維持し，Windows 10の操作が異常に遅くなる現象が発生。<br/>
数日後の2016年12月20日には，ノートPCの電源投入後にBIOSの設定画面が強制表示され，Windows 10の起動が不可になる現象に置き換わる。<br/>
12月22日にメーカーであるASUSのカスタマーサービスに問い合わせたところ，ハードウェア上の問題の可能性が高い旨回答あり。
取り急ぎデータの復旧を目的にヨドバシカメラのサービスに依頼したところ，データ復旧センター(?)から電話があり，磁気ヘッドの故障であり，
復旧には\148,000の費用が掛かるとのこと。<br/>
費用が高額であることからデータ復旧は諦めることに。メインPCもASUSのノートPCから再びNECOに変更することにした。
</p>
<h2>SHINYA-PC復旧 (2017/3/25)</h2>
<p>
メインPCをNECOに切り替えたものの，処理性能が遅く，頻繁にスタンが発生。ストレスが大きいため，メインPCをSHINYA-PCに戻すべく，2017年3月中旬に修理を依頼し3月25日に復旧した。
</p>
<ul>
<li>修理費用:￥64,425</li>
<li>バックアップ対策として購入したUSBメモリ(32GB):￥2,780</li>
<li>バックアップ対策として購入したSDカード(64GB):￥11,640</li>
</ul>
<p>
Windows 8.1の初期設定後，Windows 10に更新する。
Windows 10に更新後，初期状態から不要なソフトウェアを削除する。削除するソフトウェアは次のとおり。
</p>

<table class="tblstyle"><tr><td>
Kingsoft Office, デジタルアーツ iフィルター, Foxit PhantomPDF, WebStorage, WebStorage(WSA), Skype, Skype(WSA), 
Candy Crush Soda Saga(WSA), Facebook(WSA), Flipboard(WSA), Keeper Password Manager(WSA), Line(WSA), Minecraft(WSA), 
Music Maker Jam(WSA), NAVITIME(WSA), Netflix(WSA), Phototastic Collage(WSA), TripAdvisor Hotels Flights Restaurants(WSA), 
Twitter(WSA), Zinio Reader(WSA), マーチオブエンパイア(WSA)
<br/>
※WSA : Windowsストアアプリ<br/>
※McAfeeのセキュリティソフトウェアは，Windows 10に更新したときに自動的に削除される。<br/>
</td></tr></table>

<p>
SHINYA-PCにインストールするソフトウェアは次のとおり。
</p>
<ul>
<li>Microsoft Office 2010</li>
<li>Visual Studio 2017 Community</li>
<li>InstallerProjects (Visual Studio 2017 Community add-on)</li>
<li>wkhtmltopdf 0.12.0.3</li>
<li>PDFtk Server 2.02</li>
<li>7-Zip 9.20</li>
<li>Line Counter 1.4</li>
<li>SourceTree 1.10</li>
<li>GIMP 2.8</li>
<li>FFFTP 1.98g</li>
<li>VMware Player 最新版</li>
<li>Firefox 最新版</li>
<li>Chrome 最新版</li>
<li>Abyssmedia Wave Editor 3.3.5.1</li>
<li>e frontier Shade 13</li>
<li>PIXELA VideoBrowser + 最新版アップデート</li>
</ul>
</div>
</div>


<p>
<IMG SRC="tail.gif" alt="Tail bar">

</div>
</div>

</BODY>

</html>
