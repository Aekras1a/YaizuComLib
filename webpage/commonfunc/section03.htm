<HEAD>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="content-style-type" content="text/css">
<link rel="stylesheet" href="./style.css" type="text/css">
</HEAD>

<BODY>
<div id="container">
<H1>3. StkProperties</H1>

<H2 ID="3.1">3.1 StkProperties概要</H2>
<div class="topic">
StkPropertiesは，ユーザーが定義したプロパティファイルからプロパティ情報を取得するAPIセットを，クライアントプログラムに提供します。<br>
</div><p>



<H2 ID="3.2">3.2 StkPropertiesの使用方法</H2>
<div class="topic">
StkPropertiesの機能を利用するために，クライアントプログラムは，以下の.hファイル，.libファイルを事前に参照可能な状態にしておく必要があります。<p>
<table class="tblstyle">
<tr><td>.hファイル</td><td>StkProperties.h</td></tr>
<tr><td>.libファイル</td><td>commonfunc.lib</td></tr>
</table><p>
</div><p>



<H2 ID="3.3">3.3 int GetProperties(TCHAR* FileName)</H2>
<div class="topic">
プロパティファイルからプロパティの名称と値を読み込みます。<br>
FileNameにはファイルパスではなく，ファイル名を指定する必要があります。GetPropertiesは，現在のモジュール(実行ファイル)が存在するフォルダ内で
指定されたファイルを探索します。現在のモジュールが配置されたフォルダ以外を探索することはできません。<p>
プロパティファイルは各行[<プロパティ名> = <プロパティ値>]という形式で定義されるテキストファイルである必要があります。<br>
ファイル形式はISO 8859-1で，プロパティ名およびプロパティ値は半角英数字で指定する必要があります。
プロパティ名またはプロパティ値として全角文字コードを指定したときの挙動は保証されていません。<br>
プロパティファイルは最大でも64行（各行256文字以内）以内に収める必要があります。
また，複数のプロパティファイルを読み込む場合，定義可能なプロパティは最大で256個となります。<br>
プロパティ名に空白を含めることはできません。<br>
同じ名前のプロパティが複数定義されている場合，最初に現れるプロパティが有効となります。<p>
GetPropertiesでプロパティファイルからプロパティの名称と値を読み込んだあと，GetPropertyIntやGetPropertyStrを使用して値を取得することができます。<br>
<table class="tblstyle">
<tr><td>FileName[入力]</td><td>プロパティファイルの名称</td></tr>
<tr><td>[戻り値]</td><td>0:成功, -1:エラーが発生した</td></tr>
</table>
</div><p>



<H2 ID="3.4">3.4 int GetPropertyInt(char* PropName, int* Value)</H2>
<div class="topic">
GetPropertiesでプロパティファイルから読み込んだプロパティの値(Int型)を取得します。<br>
<table class="tblstyle">
<tr><td>PropName[入力]</td><td>プロパティの名称</td></tr>
<tr><td>Value[出力]</td><td>プロパティの値(Int型)を格納する変数へのポインタ</td></tr>
<tr><td>[戻り値]</td><td>0:成功, -1:指定したプロパティが存在しない</td></tr>
</table>
</div><p>



<H2 ID="3.5">3.5 int GetPropertyStr(char* PropName, char Value[256])</H2>
<div class="topic">
GetPropertiesでプロパティファイルから読み込んだプロパティの値(char[256]型)を取得します。<br>
<table class="tblstyle">
<tr><td>PropName[入力]</td><td>プロパティの名称</td></tr>
<tr><td>Value[出力]</td><td>プロパティの値(char[256]型)を格納する配列</td></tr>
<tr><td>[戻り値]</td><td>0:成功, -1:指定したプロパティが存在しない</td></tr>
</table>
</div><p>



</div>
</BODY>
